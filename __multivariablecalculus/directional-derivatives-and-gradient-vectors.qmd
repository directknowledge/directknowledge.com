---
pagetitle: "Directional Derivatives and Gradient Vectors - Exploring Calculus"
---
# Directional Derivatives and Gradient Vectors


## Definition of Directional Derivative

Partial derivatives find the rate of change of $z=f(x,y)$ in the directions of the $x$ and $y$ axis; that is in the direction of the unit vectors $\vec{i}$ and $\vec{j}$, respectively. 

::: {#def- } 

Let $f$ be a function of two variables, and let $\vec{u}=u_1\vec{i}+u_2\vec{j}$ be a unit vector. The \index{directional derivative} of $f$ at $P(a,b)$ in the direction of  $\vec{u} **directional derivative} of $f$ at $P(a,b)$ in the direction of  $\vec{u** $ is defined by
\[
D_{\vec{u}} f(a,b)=\lim _{h\to  0}\frac{f\left(a+h u_1, b+h u_2\right)-f(a,b)}{h}
\]
provided the limit exists.
::: 

::: {#thm- } [Directional Deriviative]
\label{dirderivative}

Let $f(x,y)$ be a function that is differentiable at $P(a,b).$ Then $f$ has a directional derivative in the direction of the unit vector 
$\vec{u}=u_1\vec{i}+u_2\vec{j}$ which is given by 
\begin{equation}
\label{dirder}
D_{\vec{u}}f(a,b)=f_x(a,b)u_1+f_y(a,b)u_2.
\end{equation}
::: 

 ::: {.proof }
We define a function $F$ of a single variable $h$ by $F(h)=f\left(a+h u_1,b+h u_2\right)$ so that
\[
D_{\vec{u}}f(a,b)=\lim _{h\to 0}\frac{f\left(a+h u_1,b+h u_2\right)-f(a,b)}{h}
=\lim _{h\to 0}\frac{F(h)-F(0)}{h}
=F'(0).
\]  
Applying the chain rule with $x=a+h u_1$ and $y=b+h u_2$
\[
F'(h)
=\frac{d F}{d h}
=\frac{\partial f}{\partial  x}\frac{d x}{d h}
+\frac{\partial f}{\partial  y}\frac{d y}{d h}
=f_x(x,y) u_1+f_y(x,y)u_2.\]
When $h=0,$ we have $x=a$ and $y=b$ so that
\[
D_{\vec{u}} f(a,b)=F'(0)=\frac{\partial f}{\partial  x}u_1
+\frac{\partial f}{\partial  y}u_2
=f_x(a,b) u_1+f_y(a,b)u_2.
\]
::: 
  
\begin{figure}[H]
\centering
\includegraphics{_includes/dir-der-1-pics.pdf}
\caption{The directional derivative of $f(x,y)=x^3-3x y+4y^2$ at $(1,2)$.}
\label{fig:dir-pd-1}
\end{figure} 

::: {#exm- } 

Find the directional derivative $D_{\vec{u}}f(x,y)$ where $f$ is the function defined by 
$$
f(x,y)=x^3-3x y+4y^2
$$ 
and $\vec{u}$ is the unit vector given by the angle $\theta =\pi /6.$ What is $D_{\vec{u}}f(1,2)?$
::: 

::: {.solution }
We let 
$\vec{u}=\cos \left(\frac{\pi }{6}\right)\vec{i}+\sin \left(\frac{\pi }{6}\right)\vec{j}$ and use \ref{dirderivative} to find 
\begin{align*}
D_{\vec{u}}f(x,y)
& =f_x(x,y)\cos  \frac{\pi }{6}+f_y(x,y)\sin \frac{\pi }{6} \\
& = \left(3x^2-3y\right)\frac{\sqrt{3}}{2}+(-3x+8y)\frac{1}{2} 
=\frac{1}{2}\left[3\sqrt{3}x^2-3x+\left(8-3\sqrt{3}\right)y\right].\end{align*}
Therefore, by \ref{dirderivative}, the directional derivative is 
\[
D_{\vec{u}}f(1,2)
=\frac{1}{2}\left[3\sqrt{3}(1)^2-3(1)+8-3\sqrt{3}\right](2)
=\frac{13-3\sqrt{3}}{2}.
\]
::: 

::: {#exm- } 
Find the directional derivative of the function $f$ defined by  
$$
f(x,y)=y^2+3y x^2
$$ 
at $P=(-1,-2)$ in the direction towards the origin. 
::: 

::: {.solution }
A vector in the direction from $(-1,-2)$ to $(0,0)$ is $\vec{i}+2\vec{j},$ so a unit vector in this direction is therefore 
\[
\vec{u}=\frac{1}{\sqrt{5}}\vec{i}+\frac{2}{\sqrt{5}}\vec{j}.
\]
We find that 
\[
f_y(-1,-2)=\left.\left(2y+3x^2\right)\right|_{(-1,-2)}=-1
\qquad  \text{and} \qquad
f_x(-1,-2)=\left.6x y\right|_{(-1,-2)}=12.
\]
Therefore, by \ref{dirderivative}, the directional derivative is 
\[
D_{\vec{u}}f(-1,-2)=\frac{1}{\sqrt{5}}(12)+\frac{2}{\sqrt{5}}(-1)=2 \sqrt{5}.
\]
::: 

\begin{figure}[H]
\centering
\includegraphics{_includes/dir-der-2-pics.pdf}
\caption{The directional derivative of $f(x,y)=x^2+3x y^2$ at $(1,2)$.}
\label{fig:dir-pd-1}
\end{figure} 

::: {#exm- } 
Find the directional derivative of the function $f$ defined by  
$$
f(x,y)=x^2+3x y^2
$$ 
at $P=(1,2)$ in the direction towards the origin. 
::: 

::: {.solution }
A vector in the direction from $(1,2)$ to $(0,0)$ is $-\vec{i}-2\vec{j},$ so a unit vector in this direction is therefore 
\[
\vec{u}=\frac{-1}{\sqrt{5}}\vec{i}-\frac{2}{\sqrt{5}}\vec{j}.
\]
We find that 
\[
f_x(1,2)=\left.\left(2x+3y^2\right)\right|_{(1,2)}=14
\qquad  \text{and} \qquad
f_y(1,2)=\left.6x y\right|_{(1,2)}=12.
\]
Therefore, the directional derivative is given by 
\[
D_{\vec{u}}f(1,2)=\frac{-1}{\sqrt{5}}(14)-\frac{2}{\sqrt{5}}(12)=\frac{-38}{\sqrt{5}}.
\]
::: 


 
## The Gradient of a Function

::: {#def- } 

Let $f$ be a differentiable function at $(a,b)$. 
Then the \index{gradient} of $f$ is denoted by $\nabla f(x,y)=f_x(x,y)\vec{i}+f_y(x,y)\vec{j} **gradient} of $f$ is denoted by $\nabla f(x,y)=f_x(x,y)\vec{i}+f_y(x,y)\vec{j** .$  
The value of the gradient at the point $P(a,b)$ is denoted by 
\[
\nabla f_P=f_x(a,b)\vec{i}+f_y(a,b)\vec{j}.
\]
::: 

::: {#exm- } 

Find the gradient $\nabla f$ of the function $f$ defined by 
$$
f(x,y)=\sin  x+e^{x y}
$$ 
and evaluate the gradient at $(0,1)$.
::: 

::: {.solution }
If $f(x,y)=\sin  x+e^{x y},$ then 
$$
\nabla f(x,y)=\langle \cos  x+y e^{x y},x e^{x y}\rangle
$$ 
and $\nabla f(0,1)=\langle 2,0 \rangle.$
::: 

::: {#thm- } [Directional Derivative and Gradient]
\label{grader}
If $f$ is a differentiable function of $x$ and $y$, then the directional derivative of $f$ at the point $P(a,b)$ in the direction of the unit vector $\vec{u}$ is 
$$
D_{\vec{u}}f(a,b)=\nabla f_P\cdot \vec{u}.
$$ 
::: 

::: {.proof }
Since 
$\nabla f_P=f_x(a,b)\vec{i}+f_y(a,b)\vec{j}$ and $\vec{u}=u_1\vec{i}+u_2\vec{j},$ we have
\[
\nabla f_P\cdot \vec{u}=f_x(a,b)u_1+f_y(a,b)u_2=D_{\vec{u}}f(a,b).
\]
::: 

::: {#exm- } 

Find the directional derivative of the function $f$ 
defined by 
$$
f(x,y)=x^2+x y+y^2
$$ 
at $P(1,-1)$ in the direction towards the origin.
::: 

::: {.solution }
We use the unit vector  
\[
\vec{u}=\left(-\frac{1}{\sqrt{2}}\right)\vec{i}+\left(\frac{1}{\sqrt{2}}\right)\vec{j}\]
and find  
$\nabla  f=(2x+y)\vec{i}+(2y+x)\vec{j}$  
to determine 
\[
D_{\vec{u}}f(1,-1)=\nabla f(1,-1)\cdot \vec{u}
=(\vec{i}-\vec{j})\cdot \left(-\frac{1}{\sqrt{2}}\right)
\vec{i}+\left(\frac{1}{\sqrt{2}}\right)\vec{j}=-\sqrt{2}.
\]
::: 


::: {#exm- } 
Find the directional derivative of the function $f$ defined by 
$$
f(x,y)=x^3y^4
$$ 
at the point $(6,-1)$ in the direction of the vector $\vec{v}=2\vec{i}+5\vec{j}.$
::: 

::: {.solution }
We first compute the gradient vector at $(6,-1)$
\[
\nabla f(x,y)=3x^2y^4\vec{i}+4x^3y^3\vec{j} 
\qquad \text{and} \qquad 
\nabla f(6,-1)=108\vec{i}-864\vec{j}.
\]
Note that $\vec{v}$ is not a unit vector, but since 
$|\vec{v}|=\sqrt{29}$, the unit vector in the direction of 
$\vec{v}$ is 
\[
\vec{u}=\frac{\vec{v}}{|\vec{v}|}=\frac{2}{\sqrt{29}}\vec{i}+\frac{5}{\sqrt{29}}\vec{j}.
\]
Therefore, by \ref{grader}, we have 
\[
D_{\vec{u}}f(6,-1)
=\nabla f(6,-1)\cdot \vec{u}
=(108\vec{i}-864\vec{j})\cdot \left( \frac{2}{\sqrt{29}}\vec{i}+\frac{5}{\sqrt{29}}\vec{j}\right)
=\frac{-4104}{\sqrt{29}}.
\]
::: 


::: {#exm- } 
Let $f(x,y,z)=x y z,$ and let $\vec{u}$ be a unit vector perpendicular to both $\vec{v}=\vec{i}-2\vec{j}+3\vec{k}$ and $\vec{w}=2 \vec{i}+\vec{j}-\vec{k}.$ Find the directional derivative of $f$ at $P(1,-1,2)$ in the direction $\vec{u}.$
::: 

::: {.solution }
The gradient is 
$$
\nabla f=\nabla (x y z)=y z \vec{i}+x z\vec{j}+x y \vec{k} 
$$ 
and 
$\nabla f_P=-2\vec{i}+2\vec{j}-\vec{k}.$ 
Now since we are looking for a unit vector perpendicular to both $\vec{v}=\vec{i}-2\vec{j}+3\vec{k}$ and 
$\vec{w}=2 \vec{i}+\vec{j}-\vec{k}$ 
we find,  $\vec{v} \times \vec{w}=-\vec{i}+7\vec{j}+5\vec{k}$ and so 
$\vec{u}=\frac{1}{\sqrt{75}}(-\vec{i}+7\vec{j}+5\vec{k}).$ 
Therefore, by \ref{grader}, we have 
\[
D_{\vec{u}}f =(-2\vec{i}+2\vec{j}-\vec{k})\cdot \left(\frac{-1}{\sqrt{75}}\vec{i}+\frac{7}{\sqrt{75}}\vec{j}+\frac{5}{\sqrt{75}}\vec{k}\right)=\frac{11\sqrt{3}}{15}.
\]
::: 

::: {#thm- } [Properties of the Gradient]
Let $f$ and $g$ be differentiable functions. Then 
 
- $\nabla c=0$ for any constant $c$ 
- $\nabla (a f+b g)=a\nabla (f)+b\nabla (g)$ for any constants $a$ and $b$ 
\item 
$\nabla (f g)=f\cdot \nabla (g)+g\cdot \nabla (f)$ 
\item 
$\nabla \left(\frac{f}{g}\right)=\frac{g\cdot \nabla (f)-f\cdot \nabla (g)}{g^2}$ provided $g^2\neq 0$ 
\item 
$\nabla \left(f^n\right)=n f^{n-1}\cdot \nabla (f)$ 
 
::: 

::: {.proof }
An outline of how each part can be proven in listed below. 
 
- The (constant rule) is proved as follows by $\nabla c=(c)_x\vec{i}+(c)_y\vec{j}=0.$ 
- The (linearity rule) is proved as follows
\[
\nabla (a f +b g)
=\left(a f_x+ b g_x\right)\vec{i}+\left(a f_x+ b g_y\right)\vec{j} 
=a\nabla (f)+b\nabla (g).
\]
- The (product rule) is proved as follows
\begin{align*}
\nabla (f g) & 
=(f g)_x\vec{i}+(f g)_y\vec{j} 
=\left(f_xg+g_xf\right) \vec{i}+\left(f_yg+g_yf\right) \vec{j} 
\\ & 
=\left[f\left(g_x\vec{i}+g_y\vec{j}\right)\right]+\left[g\left(f_x\vec{i}+f_y\vec{j}\right)\right] 
=f\cdot \nabla (g)+g\cdot \nabla (f).
\end{align*} 
- The (quotient rule) is proved as follows
\begin{align*}
\nabla \left(\frac{f}{g}\right) &
=\left(\frac{f}{g}\right)_x\vec{i}+\left(\frac{f}{g}\right)_y\vec{j} 
=\left(\frac{f_xg-g_xf }{g^2}\right)\vec{i}+\left(\frac{f_yg-g_yf }{g^2}\right) \vec{j} 
\\[5pt] 
& =\frac{\left[g\left(f_x\vec{i}+f_y\vec{j}\right)\right]-\left[f\left(g_x\vec{i}+g_y\vec{j}\right)\right]}{g^2}
=\frac{g\cdot \nabla (f)-f\cdot \nabla (g)}{g^2}.
\end{align*}
- The (power rule) is proved as follows
\[
\nabla f^n 
=\left(f^n\right)_x\vec{i}+\left(f^n\right)_y\vec{j} 
=\left(n f^{n-1}\right)f_xb \vec{i}+\left(n f^{n-1}\right)f_yb \vec{j}
=n f^{n-1}\cdot \nabla (f).
\]
 
::: 

::: {#thm- } [Orthogonality of Gradient]
Suppose the function $f$ is differentiable at the point $P$ and that the gradient at $P$ satisfies $\nabla f_P\neq 0.$ Then $\nabla f_P$ is orthogonal to the level surface (or curve) of $f$ through $P$. 
::: 
 
::: {.proof }
Let $C$ be any smooth curve on the level surface $f(x,y,z)=K$ that passes through $P(a,b,c),$ and describe the curve $C$ by the vector function $\vec{R}(t)=x(t)\vec{i}+y(t)\vec{j}+z(t)\vec{k}$ for all $t$ in some interval $I$. We will show that the gradient $\nabla f_P$ is orthogonal to the tangent vector $d R/d t$ at $P.$ Because $C$ lies on the level surface, any point $P(x(t),y(t),z(t))$ on $C$ must satisfy $f[x(t),y(t),z(t)]=K,$ and by applying the chain rule, we obtain
\[\frac{d}{d t}[f(x(t),y(t),z(t))]
=f_x(x,y,z)\frac{d x}{d t}
+f_y(x,y,z)\frac{d y}{d t}+f_z(x,y,z)\frac{d z}{d t}.
\] 
Suppose $t=t_0$ at $P.$ Then
\begin{align*}
& \left. \frac{d}{d t}\{ f[x(t),y(t),z(t)] \}\right|_{t=t_0}  \\
& \qquad = f_x\left(x\left(t_0\right),y\left(t_0\right),z\left(t_0\right)\right)\frac{d x}{d t} +   f_y\left(x\left(t_0\right),y\left(t_0\right),z\left(t_0\right)\right)\frac{d y}{d t}  + f_z\left(x\left(t_0\right),y\left(t_0\right),z\left(t_0\right)\right)\frac{d z}{d t} \\ 
& \qquad = \nabla f_P\frac{d \vec{R}}{d t}
\end{align*} 
since 
\[\frac{d \vec{R}}{d t}=\frac{d x}{d t}\vec{i}+\frac{d y}{d t}\vec{j}+\frac{d z}{d t}\vec{k}.\] 
We also know that $f(x(t),y(t),z(t))=K$ for all $t$ in $I.$ Thus, we have 
\[\frac{d}{d t}\{f[x(t),y(t),z(t)] \}=\frac{d}{d t}(K)=0\] 
and it follows that $\nabla f_P\cdot \frac{d \vec{R}}{d t}=0.$ We are given that 
$\nabla f_P\neq 0$ and $d \vec{R}/d t\neq 0$ because the curve $C$
is smooth. Therefore, $\nabla f_P$ is orthogonal to $d \vec{R}/d t,$ as required.
::: 


## Steepest Ascent and Steepest Descent

The direction of the greatest rate of increase (or decrease) of a given function at a specified point is called the direction of \index{steepest ascent} (or \index{steepest descent} **steepest ascent} (or \index{steepest descent** ). 


::: {#thm- } [Steepest Ascent/Descent]
Suppose $f$ is differentiable at the point $P$ and that the gradient of $f$ at $P$ satisfies $\nabla f_P\neq 0.$ Then 
 
- The largest value of the directional derivative $D_{\vec{u}}f$ at $P$ is 
$\left\|\nabla f_P\right\|$ and occurs when the unit vector
$\vec{u}$ points in the direction of $\nabla f_P.$ 
- The smallest value of the directional derivative $D_{\vec{u}}f$ at $P$ is 
$-\left\|\nabla f_P\right\|$ and occurs when the unit vector
$\vec{u}$ points in the direction of $-\nabla f_P.$ 
 
::: 

::: {.proof }
If $\vec{u}$ is any unit vector, then$D_{\vec{u}}f=\nabla f_P\cdot \vec{u}=\left\|\nabla f_P\right\|\|\vec{u}\| \cos  \theta =\left\|\nabla f_P\right\| \cos  \theta $  where $\theta $ is the angle between $\nabla f_P$ and $\vec{u}.$ But $\cos  \theta $ assumes its largest value of 1 at $\theta =0;$ that is,
when $\vec{u}$ points in the direction $\nabla f_P.$ Thus, the largest possible value of $D_{\vec{u}}f$ is 
\[D_{\vec{u}}f =\left\|\nabla f_P\right\|(1)=\left\|\nabla f_P\right\|.\] 
Also $\cos  \theta $ assumes its smallest value $-1$ when $\theta =\pi .$ This value occurs when $\vec{u}$ points toward $-\nabla f_P,$ and in this direction 
\[D_{\vec{u}}f =\left\|\left|\left.\nabla f_P\right\|(-1)\right.\right. =\left\|\left|\left.\nabla f_P\right\|(-1)\right.\right. =-\left\|\nabla f_P\right\|. 
\]
::: 
 


::: {#exm- } 
Sketch the level curve corresponding to $C=1$ for the function 
$$
f(x,y)=x^2-y^2
$$ 
and find a normal vector at the point $P(2,\sqrt{3}).$ 
::: 

::: {.solution }
The level curve for $C=1$ is a hyperbola given by $x^2-y^2=1$. The gradient vector is perpendicular to the level curve.
We have 
$$
\nabla f=f_x\vec{i}+f_y\vec{j}=2x\vec{i}-2y\vec{j}
$$ 
so at the point $\left(2,\sqrt{3}\right),$ $\nabla f_P=4i-2\sqrt{3}j$ is the required normal.
::: 

::: {#exm- } 
In what direction is the function defined by 
$$
f(x,y)=x e^{2y-x}
$$ 
increasing most rapidly at the point $P(2,1)$, and what is the maximum rate
of increase? In what direction is $f$ decreasing most rapidly?
::: 

::: {.solution }
We begin by finding the gradient of $f,$
\begin{align*}
\nabla f & =f_x\vec{i}+f_y\vec{j} \\
& =\left[e^{2y-x}+x e^{2y-x}(-1)\right]\vec{i}+\left[x e^{2y-x}(2)\right]\vec{j} \\
& =e^{2y-x}(1-x)\vec{i}+2 x\vec{j}\end{align*}
At $P(2,1)$, 
\[\nabla f_P=e^{2(1)-2}[(1-2)\vec{i}+2(2)\vec{j}]=-\vec{i}+4\vec{j}.\]  
The most rapid rate of increase is $\left\|\nabla f_P\right\|=\sqrt{(-1)^2+4^2}=\sqrt{17}$ and occurs in the direction of $-\vec{i}+4\vec{j}.$ The most rapid rate of decrease occurs in the direction of $-\nabla f_P=\vec{i}-4\vec{j}$ and is $-\sqrt{17}.$ 
::: 

::: {#exm- } 
Let $f(x,y,z)=y e^{x+z}+z e^{y-x}.$ At the point $P(2,2,-2),$ find the unit vector pointing in the direction of most rapid increase of $f.$
::: 

::: {.solution }
The gradient is 
\[
\nabla f=\left(y e^{x+z}-z e^{y-x}\right)\vec{i}+\left(e^{x+z}+x e^{y-x}\right)\vec{j}+\left(y e^{x+z}+e^{y-z}\right)\vec{k}.
\] 
Thus, $\nabla f(2,2,-2)=4\vec{i}-\vec{j}+3\vec{k}$ and so $\vec{u}=\frac{1}{\sqrt{26}}(4\vec{i}-\vec{j}+3\vec{k}).$ 
::: 

::: {#exm- } 
Find the maximum rate of change of the function at the given point and the direction in which it occurs 
$f(x,y)=\sqrt{x^2+2y}$, $(4,10)$ 
::: 

::: {.solution }
We find
\[
\nabla f(4,10)=\left.\frac{x}{\sqrt{x^2+2 y}}\right|_{(4,10)}\vec{i}+\left.\frac{1}{\sqrt{x^2+2 y}}\right|_{(4,10)}\vec{j} =\frac{2}{3}\vec{i}+\frac{1}{6}\vec{j}.
\]  
Thus the maximum rate of change is 
$\sqrt{(2/3)^2+(1/6)^2}=\frac{\sqrt{17}}{6}$ and occurs in the direction of 
$\frac{2}{3}\vec{i}+\frac{1}{6}\vec{j}.$ 
::: 


::: {#exm- } 
Find the maximum rate of change of the function at the given point and the direction in which it occurs 
$f(x,y)=\sqrt{y^2+2x}$, $(-4,-10)$
::: 

::: {.solution }
We find
\[
\nabla f(-4,-10)=\left.\frac{1}{\sqrt{2 x+y^2}}\right|_{(-4,-10)}\vec{i}+\left.\frac{y}{\sqrt{2 x+y^2}}\right|_{(-4,-10)}\vec{j}
=\frac{1}{2 \sqrt{23}}\vec{i}-\frac{5}{\sqrt{23}}\vec{j}.
\]  
Thus the maximum rate of change is
\[
\sqrt{\left(\frac{1}{2 \sqrt{23}}\right)^2+\left(-\frac{5}{\sqrt{23}}\right)^2}=\frac{1}{2}\sqrt{\frac{101}{23}}
\]  
and occurs in the direction of $\frac{1}{2 \sqrt{23}}\vec{i}-\frac{5}{\sqrt{23}}j\vec{.}$
::: 

::: {#exm- } 
Find the direction from $P(2,-1,2)$ in which the function  
$f(x,y,z)=(x+y)^2+(y+z)^2+(x+z)^2$ 
increases most rapidly and compute the magnitude of the greatest rate of increase.    
::: 

::: {.solution }
We compute the gradient:  
$$
\nabla  f=(4 x+2y+2z)\vec{
i}+(2x+4y+2z)\vec{
j}+(2x+2y+4z)\vec{
k}
$$
and at $(2,-1,2)$ we have,  
$\nabla f(2,-1,2)=10\vec{
i}+4\vec{
j}+10\vec{
k}$. 
Therefore, $\|\nabla f\|=\sqrt{216}$ is the magnitude of the greatest rate of increase and occurs in the direction of $10\vec{
i}+4\vec{
j}+10\vec{
k}.$   
::: 




