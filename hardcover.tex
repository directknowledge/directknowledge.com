% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  letterpaper,
  10pt,
  reqno,
  twopage,
  openany]{book}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}


% Geometry
\usepackage[includefoot]{geometry}
\geometry{
paperwidth=6in,
paperheight=9in,
inner=.75in, % inside margin 
outer=.5in, % outside margin
bindingoffset=0.35in, % gutter
top=0.85in, % .75in is okay but kinda to close to cuts, try .85in
bottom=0.25in, % looks good on kdp
twoside
}
\linespread{1}

% Math
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
%\usepackage{graphicx} 


% Header/Footer
\usepackage{fancyhdr}

\fancypagestyle{toc}{%
    \fancyhf{}%
    \fancyhead[RO]{\thepage}%
    \fancyhead[LO]{\textsl{Contents}}%
    \fancyhead[LE]{\thepage}%
    \fancyhead[RE]{\textsl{Contents}}%
}

\fancypagestyle{preface}{%
    \fancyhf{}%
    \fancyhead[RO]{\thepage}%
    \fancyhead[LO]{\textsl{Preface}}%
    \fancyhead[LE]{\thepage}%
    \fancyhead[RE]{\textsl{Preface}}%
}

\fancypagestyle{fancy}{%
    \fancyhf{}%
    \fancyhead{}
    \fancyfoot{}
    \rhead[]{\small{\textsf{\thesection. \rightmark \hfill \thepage}}}
    \lhead[\small{\textsf{\thepage \hfill Chapter \thechapter. \leftmark}}]{}
}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}{}}


% Titlepage
\usepackage{afterpage}
\usepackage{anyfontsize}

% Links & References
\usepackage{url}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={black},
    citecolor={black},
    urlcolor={black}
}

\usepackage{tocloft}
\cftpagenumbersoff{part}
\renewcommand{\cftchapfont}{\normalsize\scshape}

\usepackage{lipsum}




\usepackage{makeidx}
\makeindex

%  Commands

\renewcommand\maketitle{}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Direct Knowledge},
  pdfauthor={David A. Smith},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Direct Knowledge}
\author{David A. Smith}
\date{}

\begin{document}
\frontmatter
\maketitle
%%% Definitions 
\def\authname{David A. Smith}
\def\website{https://directknowledge.com}
\def\cred{B.S. Mathematics, M.S. Mathematics}
\def\firstTitle{Direct Knowledge}
\def\secondTitle{On the theory of connections, concepts, and geometry}
\def\publisher{David A. Smith}
\def\isbn{978-1-951290-98-6}
\def\edition{First}
\def\dedication{To my wife, Sally, and our children, \\[10pt] Courtney, Rebecca, and Benjamin, \\[10pt] whose support made this book possible}
\def\cover{Cover photo attribution: \textit{Southern Ring Nebula (NIRCam and MIRI Images Side by Side)} courtesy of NASA, ESA, CSA, STScI. Published on July 12, 2022. For more information visit: \url{https://webbtelescope.org}}


\begin{titlepage}
% First Title Page
\pagestyle{empty}\text{ }\\[1in]\begin{center} \Huge \textbf{\sc \firstTitle} \end{center}
% Dedication Page
\newpage \text{ }\vspace{1in}\begin{center}\begin{minipage}{.85\textwidth}\dedication \vfill\vfill\vfill\text{ }\end{minipage}\end{center}
% Second Title Page
\clearpage \text{ }\\[30pt]
\noindent\Large \authname \\[50pt]
\noindent\Huge \textbf{\firstTitle} \\[20pt]
\noindent\Large\textbf{\secondTitle} 
\\[25pt]\noindent\large\edition \ Edition
\vfill
%\begin{flushright}
%\raisebox{-.2\height}{\includegraphics[width=22pt]{/assets/direct-knowledge-logo-book.png}}\huge{\,Direct Knowledge}
%\end{flushright}
% Copyright Page
\newpage\footnotesize\noindent\cover \vfill \text{ } \\[7pt]
ISBN: \isbn \\[10pt]
\copyright \authname. 
All rights reserved. \\ \\ \\ 
This work is subject to copyright. \\ \\ 
This work may not be translated in whole or in part without the written permission of \publisher\ except for brief excerpts in 
connection with reviews or scholarly analysis.  Use in connection with any form of information storage retrieval, 
electronic adaption, computer software, or by similar or dissimilar methodology now known or hereafter developed is forbidden. \\ \\ 
The use in this publication of trade names, trademarks, service marks, and similar terms, even if they are not identified as 
such, is not to be taken as an expression of opinion as to whether or not they are subject to proprietary rights. \\ \\ 
Neither the Authors, nor the Publishers, nor the Editors give any warranty, express or implied, with respect to the material 
contained herein or for any any errors or omissions that may have been made.  \\ \\  
Typeset with \LaTeX \, and written in the United States of America.  
\\[2pt] \HRule \\[0.5cm]  \authname \\ \cred \\ \website
%\begin{flushleft}
%\raisebox{-.2\height}{\includegraphics[width=14pt]{/assets/direct-knowledge-logo-book.png}}\large{\,Direct Knowledge}
%\end{flushleft}
\end{titlepage}



\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[interior hidden, borderline west={3pt}{0pt}{shadecolor}, breakable, boxrule=0pt, enhanced, frame hidden, sharp corners]}{\end{tcolorbox}}\fi

\mainmatter
\bookmarksetup{startatroot}

\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

\markboth{Preface}{Preface}

\bookmarksetup{startatroot}

\hypertarget{references}{%
\chapter*{References}\label{references}}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{0}{0}
\end{CSLReferences}


\backmatter


\printindex



\end{document}
